var D9T_AI_ICON = '\u0089PNG\r\n\x1A\n\x00\x00\x00\rIHDR\x00\x00\x00\u0096\x00\x00\x00\u0096\b\x06\x00\x00\x00<\x01q\u00E2\x00\x00\x00\tpHYs\x00\x00\x0B\x13\x00\x00\x0B\x13\x01\x00\u009A\u009C\x18\x00\x00\x0F?IDATx\u009C\u00ED\u009Dy\u0090T\u00D5\x15\u0087\u00BF\u00EEa\u0098\x01\x04\x04\x04!".(\u008A\u00C8>\u00C2\x00"\u009B\b\u0082,"\u00CB\f3\u00C360\x02\u00B1\x12\x12-S\u009A\u00ADLJKc%\u00A1JK411*\u0094\u008A\u00B8%F\u00D0h\u0082\u0089\u00C1\x18\u008C[\\b\x19\x15q\u008B\u0082\u0089\u008A\u0080\x0E\u00D3\u00D3\u00F9\u00E3\u00F40\u00CD\u00D0\u00D3\u00FD\u00DE}\u00E7\u00F5\u00BB\u00AFy_U\u00D7@\u00CF}\u00E7\x1D\u00E8_\u00BF{\u00EEr\u00CE\u008D%\u0093I""\u00B4\u0089\x07\u00ED@Da\x12\t+\u00C2\x17"aE\u00F8B$\u00AC\b_\u0088\u0084\x15\u00E1\x0Bm\u008C\u00AEZ\x1B{\x03\u00E8\u00AA\u00EB\u00CA\x11\u00CF^\u00A0\x0E\u00D8\u00E2\u00F8\u008A8p\x00f\u00DC\f\x0F\u00FF\u00DB\x1F\u00A7Lg\rbF\x17\u00AE\u008D}\nt6\u00BAcD6\u00F6\x01\x0B\u0080\u0087\x1D_Q\x044\u00C0\u0082[a\u00E3\u00AB\u00FA\x0E\u0099\n\u00CB\u00B4+l0\u00BC.";\u00ED\u0081\u008D\u00C0\x1C\u00C7W$\u0080b\u00B8\u00E7bXx\u00A6_n\u00B9\'\u008A\u00B1\u00EC\u00A3\x1Dp\x170\u00CF\u00F1\x15\r@\x1C6\u00AC\u0080\u00EAA~\u00B9\u00E5\u008EHXv\u00D2\x16\u00D8\x00T:\u00BE\u00A2\x01\u0088\u00C1\u009D\u00CB\u00A0v\u0098_n9\'\x12\u0096\u00BD\x14\x03w\x005\u008E\u00AFH\x00q\u00B8u\x19\u00AC*\u00F3\u00CB-g\u0098\u008D\n[\u00E7s\u00E0Ye\u009B\u0085H1P\u009E\u00FA\u0099\u008D6\u00C0oR?osd9!?nZ\f\u00C4`\u00DDvC\x0F=\u00A2-\u00ACW\u0080I\u00CA6\x0B\u0091\x0E\u00C0;@7\x07m\u00E3\u00C0\u00AF\u0081\x12\u00E0fG\u00D6\x13@\u0091\u0088\u00ABS)\\\u00F7\x17S7\u00CD\u00D1\u00EE\n\u00A3\u00AE\u00D5\x19%@\u00CC\u00E55\u00EB\u0080U\u008E[\'\u00E4um\x05\\~\u00B6\u00CB;)\x10\t!\x18\u00DC\u008A\u00AA\u0089\u009B\u0080o:n\u00DD\b4\u00C0u\x0B\u00E1\u008As\f\u00EFhH$\u00AC\u00F0\u00B1\x16\u00B8\u00CCq\u00EBF\u00E0\x00\\S\x01W\u009F\u00EB\u0097K\u0087\x13\t\u00CB>\u00DE\x05>\u00CE\u00D1\u00E6z\u00E0J\u00C7\x16S\u00E2\u00BA\u00F2"\u00B8\u00F6<\x0F\u009E\u00B9 \x12\u0096}\u00BC\x00\\\x00\u00FC7G\u00BB\u00AB\u0081\u00EF9\u00B6\u00DA\b|\x05\u00DF\u00B90?\u00E2\u008A\u0084e\x1F\x1D\u0080\u00ED\u00C0L`W\u008E\u00B6?\x06\u00AErl9\u00C9Aq\u00DD0\u00C3\u00D8?GD\u00C2\u00B2\u0097\u00BF\x02\u00D3\u0081\u00FF\u00E4h\u00F7\x03\u00E0\x1A\u00C7VS\u00E2\u00BAd:\u00AC\u009Bi\u00EE\\."a\u00D9\u00CDv\u009C\u0089\u00EB\n\u00E0\u00A7\u008E\u00AD&\u0081/a\u00E54\u00B8e\u00B6\u00B1oY\u0089\u0084e?\u00CF\x01\u00D3\u0080\u00F7r\u00B4\u00FB6\u00F03\u00C7VS\u00E2\u00AA\u009B\n\u00B7\u00CF5w\u00AE5"a\u0085\u0083\u00E7\x11q\u00ED\u00CC\u00D1\u00EE[\u00C0\u008D\u008E\u00AD\u00A6\u00C4\u00B5\u00E8\\X?\u00DF\u00DC\u00B9LD\u00C2\n\x0F\u00FF\x04\u00A6\x00o\u00E5h\u00F7u\u00E0\x16\u009C~\u00B6I`?TM\u0084\r\x0B<\u00F9w\b\u00DAk\u0085\u00EEI"K\u00B1\u00C1{bF=2\u0094\u00CF\x0F\u00FF\x02\u00A6\x02\u00BF\x07N\u00CD\u00D2\u00AE\x0E\u00D9zS\u008BS\u00EF\u00F6\u00C3\u00C2\u0089P\x14\u0087\u008A\u00BB\u00BC\u00BAi\u00C3\u00C7\u00D9\x16\u00B6\u00BF\x06\u009B^\n\u00DA\x113.\u009B\x00\u00DD\u008F\u00E1\u00E0\u00AE\u0082<\u00F0\x06\u00CD\u00E2:=K\u00BB%\u00C8S\u00AB\x16\u00A7;~\u00F7\u00C1\u0082\u00F1\u0090l\u0084\u00CA{\u00BC9\x19\u00BC\u00B0\u008Aa\u00DB\x0E\u00F8I\x00+\u00F0\x1A\u00CC\x1F\x02\u00DD{\u0092Oa\u0081t\u0087\u00E7#{\u00E3\x07di\u00B7\b\u00E9\x0F\x16\u00E1B\\\x15\x13!\u00E6\u00F1\u00C9\x15\u00BC\u00B0\u0092P\u0092G/b\u00C0\u00C4\x13\u00BD\u00DB\u0089\x03{\u00EA\u00A1]1\u00F9\u00EC\n\u00D3\u00D9\u0081<\u00B9~\x0B\f\u00CD\u00D2\u00AE\x12\x11W\r\u00F0\u00A5#\u00CB\u00FB`\u00C18\u0088\u009B.\u0095c\u0083\u00B0\u00F2H\x1Cxd)L\x19\u0089\u00F7t\u0090X\u00CA\u00C6\u0081\u00D4+\x18\u00DEC\u00E6\u00B9~\x07\f\u00CF\u00D2n."\u00AEJ`\u00BF#\u00CB\u00FBa\u00DEhs\u00C7\u008E\u0098Qa\f\u00D8\u00B2\f\u00A6\u0094#\u00FF\u00B5\x07<\u00BE\u00EA\u0091\u0081G\u00F0_\u00CD\x0F\u0091n\u00F1\u00EF9\u00DA\u00CD\x02\u00EEE\u0096\u008C\u009C\u00E1\u00E1\x0BsD\b+\x0El^\n\u0093G \u0099{Z$S\u00AF\u00E0\u00D9\u0085,\\?\u009D\u00A3\u00DDt`\x13p\u0094\u00DF\x0E\x15\u00BC\u00B0\u00E2\u00C0c\u00B5iO\u00AA\u00C2e\x17"\u009C\'s\u00B4\u009B\n<\b\x1C\u00ED\u00A73\x05-\u00AC&QM\u00D2~R\u00D9\u00CB\u00FF\u0090.\u00EF\u008F9\u00DAM\x02\x1E\u00C2Gq\x15\u00AC\u00B0\u008E@Q5\u00F1\x19\u00B2\u00E5&W\r\u0088s\u0090\u00A0\u00FF\x18?\u009C(Ha\u00C5c\u00A1\x16\u0095F\u00D4\u00B6\x17\u00C9\u00A4~$G\u00BB\u00B3\x11quW\u00B8\u00E7!\x04?\u00A6Q\u00A6(\x06\x7FX\x0E\x13\u00CA\b\u00A3\u00A8\x00\u00CE\x02\u00FE\u0096\u00FAs\u00AC\u00C5O\u00B2\u00BC\u00DF\u00B2M\x02\u00A9\x05\u0091\u008Br`3\u00F2\u0094\u00FB\u00C0\u00B9\u009B\u00D9)(a\x15\u00C5\u00E0\u00F1\u00E50~8a\x15\x15@\'`d\u009E\u00EF9\x1Cy\u00BA\u00CDF&^=S0]\u00E1AQ\u0095Q\u00E8\u00A3?\u00BF\x18\f\u00AC\u00D62V\x10\u00C2*\u0090\'\u0095\r\x14i\x19\n}WX\x14\u0083?\u00D5\u00C1\u00D8aD\u00A2\u00F2\u008E\u00DAto\u00A8\u009FXm\u00E3)Q\r%\u008C\u00A2j\x1B\u00B4\x03~\x12\u00EA\'\u00D6\u00A6j\x18;\x1C\x19\\;\u00E7h$\x1FO\u00E3\u0083}\x1F\u00B8\u00CE\u00E0\u00BAFd\u009Bqz\u00B9\u00CDd\u009E\u00FE\\\n\u00F4v\u00EC\u00A9!\u00A1\x15\u00D6iG\u00C3\u008Ca\u0098\x04\u00EA\x17\x00\u0097*\u00BA\u00F2(\u0092d\u00EA\u0086O\u0091\u0091_\u00CB)\u0082L]\u0091\u00D3\u00F7\u009C\u00B6\x1D\tlm\u00E5z\x0F\x1Be\x0E%\u00B4\u00C2\u00AA\x1D\u0089|\u00F7\u00DC\x0Bk\u0099\u00B2+\u008Bq/\u00AC$\u00F0\u0085\u00B2\x1FN\u00C9\u00B6\'\u00EB\u00C8\x16VQ\f\u0096\u008C\u00C0d[\u00C7\x10`\u00AC\u00B2;\u0095\u00C0\u008F\u0090u\u00BA0\u00F0*0\u0086\u00C3\u009Fd1\u00A4kW!\u0094\u00C2\u009A\u00D3\x1F\u00BA\u00F7\x02\u00BEr}i\x15\u00FA\u00FF\u00E6c\u0081\x0B\u0091\u00E2ha`\x0F\u00B0\u00CD\u00EF\u009B\u0084rTX[\u008E\u00C9C\u00FB(@9{\u00EE \u00A9\u00C2\u008C\x11M\u0084NX}:\u00C0\u00943\u0090\x1D\u009C\u00EE8\x0F\u00E8\u00A3\u00EE\u0090p6\u00D9\u00F7\u009D\x1Fq\u0084NXKG \u00CF\x1E\u00F7\t\f\u00DAA{:q$\u00DD*"E\u00A8b\u00AC\x18\u00B0\u00D4,\x11\u00A2\x1F\u00E0w=\u00BB\x05\u00C0\x0F\u00B1/\u0088?\x05Xcx\u00EDg\u00C0wM.\f\u0095\u00B0\u00A6\u00F6\u0085\x13zc2\x1A\\\u0088\x14\u0094\u00F5\u0093\x1E\u00C0E\u00C0\u00AD>\u00DF\u00C7-}\u0090\u00B4{\x13\u00BE\u00C0PX\u00A1\u00EA\nW\u008C\u00C2d\u0099\u00B4\x14\x11V>X\u0082}A\u00BC\u0097D\u00B7=\u00A6\x17\u0086FX\u00C7\u0096\u00C0\u0085\x031\t\u00DA\u00C7\u0093\u00BD\u00CE\u0081&\u00A3\u0081\u0080\u00CF\u0084\u00B0\u0083\u00D0\b\u00AB\u00AA\fYYs\x1F\u00B4/Uw\u00A6ubDA<\x10"a\u00AD(\u00C7\u00A4>B\x1F\u00A4\u00AET>\u0099\u008F\u00B3\x13\'\x0E\u00A7\x18\u00E9\u00B8[{\u00D9\u00D6\u00C9f!\x14\u00C1\u00FB\u00C8^p\u00FA\t\u0098\x04\u00ED\x15\u00E4!9\u00B3\x05\u00C7 \u0089\f\u00CE\u008E\'i\u00A2\b\u00B6\u00BE\b;[\x19S\u0096\x16\u00C3\u00FCa\u0088\u00F8\u00ECH\u0092\u00CDJ(\u0084u\u00C9Xd\u0093\u008B\u00BB\x05\u00E7bd\t\'\b\x16\x03\u00BF\u00C0M\u00C7]\f\u00DBw\u00C2\u00E5\u008Ff\u00FEu\f\u00989\x00JK\u00C8we\x1B#\u00AC\u00EF\n;\u00B7\u0081\u00F9\u00831\t\u00DAG\x03A\x1D\x0BY\u008Ed\u00DB8\u00A7\x01.\x1E\x03\u00A5\u00AD|"\u00ED\u008B \x16\u00A2\u00AE\u00D0zaU\f\u0081\u00B6]1\u00F9\u0096.Vw\u00C6\x1DK\\\u00B5n\u0080N\u00DD\u00A1\u00C2\u0092\x13R\u00BDb\u00BD\u00B0\u00EAFa2\x12\u00EC\u0089\u00EC8\b\u0092\u00F9\u00C8\u00A4\u00A9s\u0092\u00B0z\u008C?\u00CE\u00E4\x1B\u00AB\u00855\u00B8\x1B\f\u00EB\u008BI\u00D0>\x17\u009F\u008B^8\u00A0+n\u00CEu\x06\u00A8\u0087\u00B3\u00FA\u00C10wr\u00B4\x12\u00AB\u0085\u00B5r\f2\u00CCv7\n\u008A\x03\u00D5\n\u00B7\u00D7\x18{-\u00C2\u00CDZA\x12(\u0081\u008B=\x14<\u00B3\x05k\u0085U\x12\u0087\u00CA\u00E1\u0098<\u00AD\u00CA\u0080\x11\x1Eo\u00FF\x02n\u00EA\u00A5\u00B7\u00CE\b\u00DC\u00FAr\x00*\u0087A\u00FB\x16\u009FL\fhk6\u0086\u00F7\u0092+\u00D8\u00D1\u00F4Bk\u00A7\x1B\u00E6\r\u0080\u00CE=pZ53\u009D\x1A\u00BCO%>\u0084\u009C\u00C1\u00BC\x1A\u00EFI\u009C\u00CB\u00C8]\x10\u00AD\u0099\x06\u00E8\u00D8\x1D\u00AA\u0086\u00C0/\u009Fk~{\x7F#\u00BC\u00F6\x11\u009C\u00D1\x0F\u00B7\u00D3.\u00AF\x03\u00DFpuE3\u00EE\u00F2\u009F\u00D2\u00B0VX\u00AB2\u00ED\u00CA\u00CEMW\u00BC\u00EF\x12M \x15X\u00DEA\u008Asx\r\u00A7/\x02\u00BEO\u00EE\u00F3p\u009Ai\u0084Ug\x1F*\u00ACD\x12&\u00DE\b\u00DB\u00D6\u00C0\u00C9\'\u00E1\u00E6\x0B\u00F7\x01p\u0083\u00E3\u00D6JX\u00D9\x15\u009E\u00D2\x11F\u009F\u008A\u00C9\u00DC\u00D5,\u00DC\u008E\u00C4\x0E\u00E7\x05\u00E4\u00FC\x1A\u0080\u00BB=\u00DA\x02\u00E8\u0082\u00DB \u00FE\x00\f\u00ED++\x0E\u00E9|T\x0F#\u00D7\u00C2;;\u0090\u00D8\u00D3b\u00AC\x14V\u00DDh\u00A4\x04\u00AB\u00FB\'V\u008D\u00C2\u00ED\u00EFM\u00BB\u00F3\x03x\u00D8:\u0092\u0086Q\x10\u00BF2C\x10\u00BF\u00BB\x1E\u00CA~\x0E/\u00BF\u008E\u00C5\u00FD\u008D\u0085\u00C2jc\u009E\u00DA5\b\u00A9R\u00E7\u0085\u00FD\u00C0\u00C6\u00B4\u00BF\u00BFO\u00EE\u00E2eN(\x03F\u00B9\u00BA\u00A2\x1E*\u0086B\u00A7\fr\u00DC]\x0F7o\u00C3\u00C2O\u00AF\x19\u00EB\\\u009ByZ*\u00B5\u00CB\u00FD\u00F6\u00B4*\u00BC\x07\u00DA\u008F\x03o\u00B7x\u00EFN\u008F6\u009Bp\u00B7\u00E7>\x01\u00A5\u00DD`a\u0086\x14\u008D\u00AA\u0081pc\x05\u00DEk\u00D5\u00FB\u0088u\u00C2Z9\x1A\u00D3\u00D4\u00AEJ\u0085\u00DBo\u00CC\u00F0\u00DEVt\u008A\u0091\u00CD\x01z\u00E5l\u0095N*\u0088O\u00A7j \u00AC_\u008Et\u0083\u00C1\u009C\u0088\u00E1\b\u00AB\u0084u\\;\u0098\u00DC\x1F\u0093\u00A0}:p\u00BC\u00C7\u00DB\x7F\u008C\x1C|\u00D4\u0092\u00BD\u00C0}\x1Em\u0083lStwp\u00DB\x01\x18tR\u00F3L|\u00F5@X_\u008B|\u00F1,\u00DF\u00E1`U\u00F8\u00B7\u00BC\x1C\u0099\u0092s_\u008Fa\u0091\u00C2\u00ED\u00B7\u00D0z\u0086\u00CD\u00DDH\u00A6\u008B\u00D7\u00AEv12\u00F1\u00EA\u00AC\x13K\x02\u00A5\u00B2\x02Q\u00F7\x00\u00FC\u00AA\x12\u00F9\u00C4\u00DC\u00C5\u009FC\u0081u\u00EE\u00DC<\u00C8n\u00A4\u0088\u008Ak\u00AC\x10VC\u00EA\u0091^[N\u0090\u00A9]\u00D9b\u00A9\x7F S\x10\u00EE\u00B6\u00C2\x1C\u00CE\x10d^,W\u0091\u00FFfRA\u00FC\u00F5O@C\x02\u00DA\u00BA\u00EF\u00FE:c^\u00D3\u00F4S\u00C3\u00EB\u00EC\u00E8\n\u00F7\u00D5\u00C3Y=\u00E1\u00F8\u00E30\u00DD%\u00EA\u00B5\u00D6\u00D5\u00EB@\u00B6\u0083\u00ED\u0092\u0080\u00C2\u00F1\u0090\u0080\u009C\x1F\u00E8\u009C\x04t\u00EC&\u00CB<_\u00B8\u00AFU\x01\u00DE"1\u00E3j\u00AE\u00C1\x0B+5c\u00B4z\f&\x1DM\t:\x0B\u00CE\u00F7\u0091\u00BB\u00C4\u00C8&<,q\u00A41\x0B8\u00CE\u00D5\x15\t\u00D9\x04\u00D8\u00A9\x1D\u00A1\u00D8\u0096\f6\b+\x01\x03z\u00C2,\u00B3\u00D4\u00AE\u00F3\u00F0\u009E\u00DA\u00D5\u0080L\u008A\u00E6\u00E2]r\u009F\u00F6\u00E0\u0084N\u00C8S\u00D69\t\u00F8Z\x0F(m\u008F\u00D5#\u00C1t\u0082\x17V\x03L\u00EB\x0F]\u00CCR\u00BB4\u0082\u00F6gq^8M\u00AB;l:\u00F9\u00D49!\x11T\x13\u00C1\x0B+\t1\u00B3u\u00AF>\u00C89}^qs\u00FA\u00F1\x16\u00E4\u00C9\u00E5\u0095AH\u0085\u009A\u0082%xa\u0081i\u00DC0\x177\u0087:f\u00C6\u00ED\x1C\u00D5^d\u00E7\u0083\x06~V\u00BF\t\x1C;\u0084\u00E5\u009E6\u00E8d\x1C?\u008A\u00FB\'\u00D0\x1D\u00E8\u0084\u00D0\u00B3\u00F0>\u00A9k-a\x15\u00D6x`\u00A0\u0082\x1D7\u00DD`\x13\u00DB\u0091\u00B8\u00CC+\x1D\u00C9_\u00B1\u0092\u00BC\x13Vail\u008F\u00F9\x10\u00B3Q^#f\u0082\u00CCD\r\x05z\u0090@\x18\u0085\u00D5\x139\x02\u00CD+\u008F\x00\u009F\x1B^{\x1F:sZ\x03\u00D0\u00AF\u00E2l\x05a\x14\u00D6ltR\u00BB\u00BCl\u0087\u00D9A\u00EBE\u00F8\u00DD\u00B2\\\u00C9\u008EU\u0084MX1tFS/\u00E3\u00BD$\u00F5\x1D\n~\x00\u00CC\x00NT\u00B2e\ra\x13\u00D6(t\n\u009Bm\u00C2dU\u00F2P6\u00A3Sp\u00BF\x03\x05\x18\u00C4\u0087MX\u00D5xO\u00ED\u00AAG\u0084\u00E5\u0095=\u00C8\u009Ex\r\u00AA\u00F1\u00BFFj^\t\u0093\u00B0\u00BA"\u00A9T^y\x06xE\u00C1\x0E\u00C8>-\u008D9\u00AD\u00FE\u00C08\x05;\u00D6\x10&a]\u0080\u00F7\u00D4.\u00D0[\u00EF\x03\u00C9;|Q\u00C9VA\x05\u00F1a\x12\u0096F-\u00D1\u00CF\u0081\x07\x15\u00EC4\u0091\u00C0\u00D9\u00CE\b\'L\x07NR\u00B2\x158a\x11\u00D6\x19x\u00CFH\x06\t\u00B8?T\u00B0\u0093\u00CE\u00DD\u0098\x14\x028\u009C\u00F6\x14P\x10\x1F\x16a-\u00C6\u00ED6\u0093\u00CCh\u00CD\u0098\u00A7\u00F3\x16\u00926\u00A6A\r\u00D6\u00E78;#\f\u00C2\u00EA\u0084\u00CE7y\x07\u00F2\u00C4\u00F2\x03\u00AD\u00DC\u00C3\u00D3\u0080\tJ\u00B6\x02\u00C5\u008Ad\u008A\x1CLF\u00E7\f\u00E3\u00C7\u0090\x11\\;\x05[-\u00F93\u00D2\u00C5\u00BA\u00CB\x1B\u00CC\u00CCr\u00FC\u00FB\x02\u00E4\u008D0\bKk\u00DF\u00D2l\u00FC;\u00A8\u00A9\u0091C\x0F\x0E\u00F7\u00C2\u00F9@_\u00E0M%{\u0081`\u00BB\u00B0N\x06&*\u00D9\u00EA\u0081\u00CEt\u0085\u00DF\u00B4C&L\u00AF\n\u00DA\x11/\u00D8\x1Ec\x15L0\u00EB\u0092j\u00FC\u00E9\u00B2\u00F3\u0086\u00CD\u00C2j\u0087\u00CE\u00BE\u00AB0r\n0)h\'\u00BC`\u00B3\u00B0\u00C6#\u00B1\u00C6\u0091\u008A\u00BB\u00C4V\u00CB\u00B0YX\x05\u009Dl\u00E0\u0080\u00A9H\u00F9\u0080Pb\u00AB\u00B0z\u00A3\u0093\u00DA\x15fJ\u00D1\u00C9\u00F2\x0E\x04[\u0085\u00B5\x00\u00EF\u00A9]\u0085@\x15\u00B2\u00D4\x13:l\x14V1\u00C1\u009F\u0083c\x0B\'\u00E3\u00FF!\u00E9\u00BE`\u00A3\u00B0\u00C6\u00A0\u0093\u00DAU(\u00AC\b\u00DA\x01\x13l\x14\u00D6\u0092\u00A0\x1D\u00B0\u008C\u00C9\u0084ptl\u009B\u00B0\u00BA#\x19\u00C2\x11\u00CD\u0094\x10\u00C2\u00D0\u00C06a\u00CD!\u00F8S\u00BBl\u00A4\u0086\u0090\rfl\x12V\x11!\u009F\x14\u00F4\u0091\x13\u0091Z`\u00A1\u00C1\u00A6E\u00E82\u00BC\u00D7\u00F8\x04)o\u00F8$vT\u0094*A\u00F6Wi|\u0081W\u00A0\u0097\x15\u00E4;6\tK+\u008Ex\x18\u00EF\x075i\u00F24rF\u00B4W&!\u00D5\x0B\u00DFP\u00B0\u00E5;\u00B6t\u0085\u009D\u00D1I\u00ED\x02X\u00AFdG\x0B-\x7F\u00DA\x12\u00A2 \u00DE\x16a\u00CDDg\u00AF\u00D4\x0E\u00E0\t\x05;\u009Al\u00C2CY\u00EB\x16\u00D4 \u00A7pX\u008F-\u00C2\u00D2\u00CA\u00A9\u00BB\x1F\u009D*0\u009A|\u0084^\u00CAY\x1Fdq\u00DAzl\x10\u00D6`tR\u00BB\x1A\u00C9|\x16\u008E\rhv\u00CFu\u008A\u00B6|\u00C3\x06ai\u009C\u00DA\x05\u00F0\x12Rm\u00CFF\u009E\x04^U\u00B25\x0E\u00C9\u00E6\u00B1\u009A\u00A0\u0085\u00D5\x01\u009DS\u00BB@2\u0092m\u0098b\u00C8D\x03:\u00A7\u00B5\u0082\x04\u00F1K\u0094l\u00F9F\u00D0\u00C2\u009A\u008ANj\u00D7\u0097\u00F8\u0093\u008C\u00AA\u00C9\x06<\x1C!\u00D2\u0082j$\u00DF\u00D2Z\u0082\x16\u0096\u00D6L\u00FBV\u00ECO\u0097z\x0B\u00C9m\u00D4\u00A07\u0096\x07\u00F1A\n\u00AB\x1Fz\t\x03\u00B6\x06\u00ED-\u00D1\f\u00E2\u00AD\u00DEN\x13\u00A4\u00B0*\u00D1\u00A9\x18\u00FC\tzE\u00FD\u00FDf3\u00B0S\u00C9\u00D68\u00A4\u00AE\u0096\u0095\x04%,\u00ADS\u00BB@\x0E\x01\u00D8\u00ADd\u00CBo\u00B4Nk\x05\u00D9ikm\u00C2IP\u00C2\u009A\u0080\u00E4\u00CEi`\u00DB\x12N.nG\u00EF\u00E0\u00DD*\u00F4R\u00FBU\tJXZA\u00FB\u009B\u00E8\u0095\u00C5\u00CE\x17/\x02O)\u00D9\u00EA\x05LS\u00B2\u00A5J\x10\u00C2:\x01\u00BD\u00FF\u008C\u00FB\u00D1\x1B\u00C2\u00E7\u0093\u0082\x0F\u00E2\u0083\x10\u00D6<tR\u009A\x12\u00D8?w\u00D5\x1A\x0F\u00A0\x17\x17\u008E\x05\u00CET\u00B2\u00A5F\u00BE\u0085\u00A5uj\x17\u00C0\u00F3\u00C8\x01\u00E0a\u00E4\x13d\u00DF\u0098\x06m\u00B0p\u00E7m\u00BE\u00855\x1A9?F\u0083{\t\u00CD\t\u00C9\x19\u00B9M\u00D1V\x05\u0096\u00E5\n\u00E4SX1\u00E0RE{Z\u00D5\u008A\u0083b\x1Bz\u00F5\u00E6{\u00D2z9M/\u00BB\u0084\u008DG\u009C\u00F9\u00DC\u009A\\\u008C\u0094T|^\u00C1\u00D6\u00BB\u00C0\u00DB\nv\u0082\u00A4\x01X\u0083\u00DE\x11\u00BE\u00AD\u00C5lob^\u00C4m\u008F\u00E1u\u00C4\u0092I\u0083\u00DEdml7\u00D0-\u00C3o\u009EAg\x7Fw\u0084-\u00AC1\u008B6\u0082^\u0084\u008E(P"aE\u00F8B$\u00AC\b_\u00B0)\u00AF0"?\x1C\x0F\u00ACl\u00E5wO\u00A1Tc^[X\u00B6n\r\u008Eh\u00E6X\u00E0\u00CAV~w\x13\u0096\n\u00EBt\u00E0!e\u009B\x11\u00BAt\u00C9\u00F2;\u00B5uWmauA\u00E7\u0084\u00F9\u0088\u0090\x13\x05\u00EF\x11\u00BE\x10\t+\u00C2\x17"aE\u00F8\u0082\u00A9\u00B0\u00A2i\u008A\u00C2D##\x1D0\x17\u00C8.\u00F4\u00F6mG\u00D8\u0083\u00F1\u00A2sK\u00CC\x16\u00A1#"r\x10\u00C5X\x11\u00BE\x10\t+\u00C2\x17"aE\u00F8B$\u00AC\b_\u0088\u0084\x15\u00E1\x0B\u0091\u00B0"|\u00E1\u00FF\'\u00B0\u00C2)\u00A7\u0097\u00E5X\x00\x00\x00\x00IEND\u00AEB`\u0082';

(function() {

    // ===============================================================
    // =================== CONFIGURAÃ‡ÃƒO FÃCIL ======================
    // ===============================================================
    var EASY_CONFIG = {
        ICON_ROOT_PATH: "D:\\PROJETOS\\SCRIPTS AFTER\\GNEWS-D9-TOOLS\\icons",
        THUMBNAIL_SIZE: 80,
        THUMBNAIL_PADDING: 2,
        GRID_COLUMNS: 6,
        GRID_ROWS: 5,
        PREVIEW_PADDING: 5  // <- NOVO: CONTROLE DO PADDING DO PREVIEW
    };
    // ===============================================================

    var CONFIG = { CACHE_FILENAME: "IconBrowser_v34_Cache.json" };
    var THEME = {
        bgColor: '#0D0A0Aff',
        panelBgColor: '#0D0A0Aff',
        detailsBgColor: '#0D0A0Aff',
        normalColor: '#efefefff',
        highlightColor: '#D3003Aff',
        slotBgColor: '#181818ff'
    };

    // --- LÃ“GICA DE AJUDA ---
    function showIconBrowserHelp() {
        var helpTheme = {
             bgColor: [0.05, 0.04, 0.04, 1], normalColor: [0.93, 0.93, 0.93, 1], highlightColor: [0.83, 0, 0.23, 1]
        };
        function setHelpStatusColor(element, color) { try { if (element && element.graphics) { element.graphics.foregroundColor = element.graphics.newPen(element.graphics.PenType.SOLID_COLOR, color, 1); } } catch (e) {} }

        var helpWin = new Window("dialog", "Ajuda - Icon Browser", undefined, { closeButton: true });
        helpWin.orientation = "column"; helpWin.alignChildren = ["fill", "fill"]; helpWin.spacing = 10; helpWin.margins = 15;
        helpWin.graphics.backgroundColor = helpWin.graphics.newBrush(helpWin.graphics.BrushType.SOLID_COLOR, helpTheme.bgColor);
        
        var headerPanel = helpWin.add("panel", undefined, "");
        headerPanel.orientation = "column"; headerPanel.alignChildren = ["fill", "top"]; headerPanel.alignment = ["fill", "top"]; headerPanel.spacing = 10; headerPanel.margins = 15;
        
        var titleText = headerPanel.add("statictext", undefined, "AJUDA - ICON BROWSER");
        titleText.graphics.font = ScriptUI.newFont("Arial", "Bold", 16); titleText.alignment = ["center", "center"];
        setHelpStatusColor(titleText, helpTheme.highlightColor);

        var mainDescText = headerPanel.add("statictext", undefined, "Esta ferramenta permite navegar, buscar e importar Ã­cones (.png, .ai) diretamente no seu projeto do After Effects.", {multiline: true});
        mainDescText.alignment = ["fill", "fill"]; setHelpStatusColor(mainDescText, helpTheme.normalColor);

        var topicsTabPanel = helpWin.add("tabbedpanel");
        topicsTabPanel.alignment = ["fill", "fill"]; topicsTabPanel.margins = 15;

        var allHelpTopics = [
            {
                tabName: "USO BÃSICO",
                topics: [
                    { title: "â–¶ Grid de Ãcones e PaginaÃ§Ã£o", text: "Navegue pelos seus Ã­cones visualmente. Use as setas â—„ e â–º abaixo da grade para mudar de pÃ¡gina." },
                    { title: "â–¶ Importar um Ãcone (Duplo-Clique)", text: "DÃª um duplo-clique em qualquer Ã­cone para importÃ¡-lo para o seu projeto atual. Se uma composiÃ§Ã£o estiver aberta, o Ã­cone serÃ¡ adicionado como uma nova camada no centro." },
                    { title: "â–¶ Ver Detalhes (Clique Simples)", text: "Clique uma vez em um Ã­cone para selecionÃ¡-lo. Isso exibirÃ¡ uma prÃ©-visualizaÃ§Ã£o maior e informaÃ§Ãµes detalhadas como nome, tipo, tamanho e data no painel 'Detalhes' Ã  direita." }
                ]
            },
            {
                tabName: "BUSCA E FILTROS",
                topics: [
                    { title: "â–¶ Buscar por Nome", text: "Digite no campo 'Buscar' para filtrar instantaneamente os Ã­cones cujo nome corresponda ao texto digitado." },
                    { title: "â–¶ Filtro de Categoria", text: "As subpastas dentro da sua pasta principal de Ã­cones aparecem como 'Categorias'. Selecione uma para ver apenas os Ã­cones daquela pasta." },
                    { title: "â–¶ Filtro de Tipo e OrdenaÃ§Ã£o", text: "Use o menu 'Tipo' para ver apenas Imagens (PNG) ou Vetores (AI). Use 'Ordenar por' para organizar a lista por nome (A-Z) ou por data de modificaÃ§Ã£o (mais recentes primeiro)." },
                    { title: "â–¶ BotÃ£o de Atualizar (â†»)", text: "Clique neste botÃ£o para forÃ§ar o script a re-escanear sua pasta de Ã­cones. Use isso se vocÃª adicionou, removeu ou renomeou arquivos enquanto o painel estava aberto." }
                ]
            }
        ];

        for (var s = 0; s < allHelpTopics.length; s++) {
            var currentTabSection = allHelpTopics[s];
            var tab = topicsTabPanel.add("tab", undefined, currentTabSection.tabName);
            tab.orientation = "column"; tab.alignChildren = ["fill", "top"]; tab.spacing = 10; tab.margins = [10, 5, 10, 5];

            for (var i = 0; i < currentTabSection.topics.length; i++) {
                var topic = currentTabSection.topics[i];
                var topicGrp = tab.add("group");
                topicGrp.orientation = "column"; topicGrp.alignChildren = "fill"; topicGrp.spacing = 5;

                var topicTitle = topicGrp.add("statictext", undefined, topic.title);
                topicTitle.graphics.font = ScriptUI.newFont("Arial", "Bold", 12);
                setHelpStatusColor(topicTitle, helpTheme.highlightColor);

                if(topic.text !== ""){
                    var topicText = topicGrp.add("statictext", undefined, topic.text, { multiline: true });
                    topicText.graphics.font = ScriptUI.newFont("Arial", "Regular", 11);
                    setHelpStatusColor(topicText, helpTheme.normalColor);
                }
            }
        }

        var closeBtn = helpWin.add("button", undefined, "OK");
        closeBtn.alignment = "center";
        closeBtn.onClick = function() { helpWin.close(); };

        helpWin.center();
        helpWin.show();
    }
    
    // --- FunÃ§Ãµes UtilitÃ¡rias ---
    function hexToRgb(hex) { if (typeof hex !== 'string') return [1, 1, 1, 1]; var cleanHex = hex.replace('#', ''); var r = parseInt(cleanHex.substring(0, 2), 16) / 255; var g = parseInt(cleanHex.substring(2, 4), 16) / 255; var b = parseInt(cleanHex.substring(4, 6), 16) / 255; var a = (cleanHex.length === 8) ? (parseInt(cleanHex.substring(6, 8), 16) / 255) : 1; return [r, g, b, a]; }
    function setFgColor(element, hexColor) { try { var color = hexToRgb(hexColor); element.graphics.foregroundColor = element.graphics.newPen(element.graphics.PenType.SOLID_COLOR, color, 1); } catch (e) {} }
    function setBgColor(element, hexColor) { try { var color = hexToRgb(hexColor); element.graphics.backgroundColor = element.graphics.newBrush(element.graphics.BrushType.SOLID_COLOR, color); } catch (e) {} }
    function simpleButton(parent, options) { var btn = parent.add('button', undefined, options.labelTxt); btn.preferredSize.width = options.width || 80; btn.preferredSize.height = options.height || 24; btn.leftClick = btn; return btn; }
    function addClickHandler(element, handler) { if (!element) return; if (element.leftClick) { element.leftClick.onClick = handler; } else { element.onClick = handler; } }
    function getObjectKeys(obj) { if (typeof obj !== 'object' || obj === null) return []; var keys = []; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { keys.push(key); } } return keys; }
    function formatFileSize(bytes) { if (bytes === null || isNaN(bytes)) return "-"; if (bytes === 0) return '0 Bytes'; if (bytes < 1024) return bytes + ' Bytes'; else if (bytes < 1048576) return (bytes / 1024).toFixed(1) + ' KB'; else return (bytes / 1048576).toFixed(1) + ' MB'; }
    function getFileType(filename) { var ext = (/[.]/.exec(filename)) ? /[^.]+$/.exec(filename)[0].toLowerCase() : ''; switch (ext) { case 'png': return 'Imagem PNG'; case 'ai': return 'Vetor do Illustrator'; default: return 'Arquivo'; } }
    
    var SCRIPT_INFO = { name: "Icon Browser", version: "34.7"};
    var UI_CONFIG = { grid: { columns: EASY_CONFIG.GRID_COLUMNS, rows: EASY_CONFIG.GRID_ROWS, thumbSize: EASY_CONFIG.THUMBNAIL_SIZE, gap: 5, padding: EASY_CONFIG.THUMBNAIL_PADDING }};
    var SUPPORTED_EXTENSIONS = /\.(png|ai)$/i;
    var State = { allIcons: [], filteredIcons: [], selectedIconData: null, lastClickTime: 0, lastClickedSlotId: -1, doubleClickDelay: 500, currentPage: 0 };
    var UI = { elements: {}, gridSlots: [], activeSlot: null, win: null };
    
    var Logic = {
        stringify: function(obj) { try { return obj.toSource(); } catch (e) { return "[]"; } },
        saveCache: function() { try { var cacheFile = new File(Folder.userData.fsName + "/" + CONFIG.CACHE_FILENAME); cacheFile.encoding = "UTF-8"; cacheFile.open("w"); cacheFile.write(Logic.stringify(State.allIcons)); cacheFile.close(); } catch (e) { UI.logMessage("NÃ£o foi possÃ­vel salvar o cache.", true); } },
        loadCache: function() { var cacheFile = new File(Folder.userData.fsName + "/" + CONFIG.CACHE_FILENAME); if (!cacheFile.exists) return false; try { cacheFile.open("r"); var content = cacheFile.read(); cacheFile.close(); State.allIcons = eval(content); if (typeof State.allIcons !== 'object' || State.allIcons.length === undefined) { State.allIcons = []; return false; } return true; } catch (e) { UI.logMessage("Cache corrompido ou invÃ¡lido.", true); return false; } },
        scanFolder: function(folder, category) { var icons = []; var files = folder.getFiles(); for (var i = 0; i < files.length; i++) { var file = files[i]; if (file instanceof File && SUPPORTED_EXTENSIONS.test(file.name)) { var modifiedDate = new Date(0); try { if (file.modified instanceof Date) { modifiedDate = file.modified; } } catch (e) {} icons.push({ nome: decodeURI(file.name).replace(/\.[^.]+$/, "").replace(/[-_]/g, ' '), fullPath: file.fsName, categoria: category, modified: modifiedDate }); } } return icons; },
        rescanAndLoadDatabase: function() { 
            if (UI.win) { 
                UI.win.enabled = false; 
                UI.logMessage("Buscando Ã­cones... A interface pode congelar. Aguarde.", false); 
                try { UI.win.update(); } catch(e){} 
            } 
            try { 
                State.allIcons = []; 
                var rootFolder = new Folder(EASY_CONFIG.ICON_ROOT_PATH); 
                if (!rootFolder.exists) { 
                    throw new Error("A pasta raiz nÃ£o foi encontrada!"); 
                } 
                
                // DIAGNÃ“STICO: LOG DE TODOS OS ARQUIVOS ENCONTRADOS
                UI.logMessage("=== DIAGNÃ“STICO DE ARQUIVOS ===", false);
                var allFiles = rootFolder.getFiles();
                var pngCount = 0, aiCount = 0, otherCount = 0;
                
                for (var f = 0; f < allFiles.length; f++) {
                    var file = allFiles[f];
                    if (file instanceof File) {
                        var ext = (/[.]/.exec(file.name)) ? /[^.]+$/.exec(file.name)[0].toLowerCase() : '';
                        UI.logMessage("Arquivo: " + file.name + " | ExtensÃ£o: ." + ext, false);
                        if (ext === 'png') pngCount++;
                        else if (ext === 'ai') aiCount++;
                        else otherCount++;
                    }
                }
                
                UI.logMessage("Resumo: " + pngCount + " PNG, " + aiCount + " AI, " + otherCount + " outros", false);
                UI.logMessage("=== FIM DIAGNÃ“STICO ===", false);
                
                State.allIcons = State.allIcons.concat(Logic.scanFolder(rootFolder, "Raiz")); 
                var subFolders = rootFolder.getFiles(); 
                for (var i = 0; i < subFolders.length; i++) { 
                    if (subFolders[i] instanceof Folder) { 
                        State.allIcons = State.allIcons.concat(Logic.scanFolder(subFolders[i], subFolders[i].name)); 
                    } 
                } 
                UI.logMessage(State.allIcons.length + " Ã­cones encontrados.", false); 
                Logic.saveCache(); 
                UI.updateCategoryDropdown(); 
                State.currentPage = 0; 
                UI.updateGrid(); 
            } catch(e) { 
                UI.logMessage("ERRO: " + e.message, true); 
            } finally { 
                if (UI.win) { 
                    UI.win.enabled = true; 
                } 
            } 
        },
        importIcon: function(iconData) { 
            if (!UI.win || !UI.win.enabled) return; 
            if (!iconData) return; 
            if (!app.project) { alert("Nenhum projeto aberto."); return; } 
            try { 
                UI.win.enabled = false; 
                UI.logMessage("Importando '" + iconData.nome + "'...", false); 
                try { UI.win.update(); } catch(e){} 
                app.beginUndoGroup("Importar Ãcone: " + iconData.nome); 
                var iconFile = new File(iconData.fullPath); 
                if (!iconFile.exists) { 
                    throw new Error("Arquivo nÃ£o encontrado: " + iconData.fullPath); 
                } 
                var importOptions = new ImportOptions(iconFile); 
                var importedItem = app.project.importFile(importOptions); 
                importedItem.name = iconData.nome; 
                if (app.project.activeItem && app.project.activeItem instanceof CompItem) { 
                    var comp = app.project.activeItem; 
                    var newLayer = comp.layers.add(importedItem); 
                    newLayer.position.setValue([comp.width / 2, comp.height / 2]); 
                } 
                UI.logMessage("Ãcone '" + iconData.nome + "' importado.", false); 
                app.endUndoGroup(); 
            } catch (e) { 
                UI.logMessage("Falha ao importar: " + e.toString(), true); 
                if(app.undoInProgress) app.endUndoGroup(); 
            } finally { 
                UI.win.enabled = true; 
            } 
        }
    };

    UI.handleIconClick = function() { var clickedSlot = this.parent; if (!clickedSlot.iconData) return; var currentTime = new Date().getTime(); if (State.lastClickedSlotId === clickedSlot.uniqueId && (currentTime - State.lastClickTime) < State.doubleClickDelay) { Logic.importIcon(clickedSlot.iconData); State.lastClickTime = 0; State.lastClickedSlotId = -1; return; } UI.updateDetailsPanel(clickedSlot.iconData, clickedSlot); State.lastClickTime = currentTime; State.lastClickedSlotId = clickedSlot.uniqueId; };
    
    UI.build = function() {
        this.win = new Window("palette", SCRIPT_INFO.name + " v" + SCRIPT_INFO.version, undefined, { resizeable: false });
        this.win.orientation = "column";
        this.win.alignChildren = ["fill", "top"];
        this.win.spacing = 5;
        this.win.margins = 10;
        setBgColor(this.win, THEME.bgColor);
        
        var headerGroup = this.win.add("group");
        headerGroup.orientation = "stack";
        headerGroup.alignment = 'fill'; 

        var titleGroup = headerGroup.add("group");
        titleGroup.alignment = 'left';
        
        var titleText = titleGroup.add("statictext", undefined, SCRIPT_INFO.name);
        titleText.graphics.font = ScriptUI.newFont("Arial", "Bold", 14);
        setFgColor(titleText, THEME.highlightColor);
        
        var helpBtnGroup = headerGroup.add('group');
        helpBtnGroup.alignment = 'right';

        try {
            if (typeof themeIconButton !== 'undefined' && typeof D9T_INFO_ICON !== 'undefined') {
                this.elements.helpBtn = new themeIconButton(helpBtnGroup, { icon: D9T_INFO_ICON, tips: ["Ajuda sobre o Icon Browser"] });
                this.elements.helpBtn.leftClick.onClick = showIconBrowserHelp;
            } else { throw new Error("themeIconButton nÃ£o definido"); }
        } catch(e) {
            this.elements.helpBtn = helpBtnGroup.add("button", undefined, "?");
            this.elements.helpBtn.preferredSize = [25, 25];
            this.elements.helpBtn.helpTip = "Ajuda sobre o Icon Browser";
            this.elements.helpBtn.onClick = showIconBrowserHelp;
        }
        
        var mainGroup = this.win.add("group"); mainGroup.orientation = "row"; mainGroup.alignChildren = ["top", "top"];
        var leftColumn = mainGroup.add("group"); leftColumn.orientation = "column"; leftColumn.alignChildren = ["fill", "top"];
        var controlsPanel = leftColumn.add("panel", undefined, "Controles");
        controlsPanel.orientation = "column"; controlsPanel.alignChildren = ["fill", "top"];
        setFgColor(controlsPanel, THEME.normalColor); setBgColor(controlsPanel, THEME.panelBgColor);

        var controlsGroup = controlsPanel.add('group'); 
        controlsGroup.orientation = 'row'; 
        controlsGroup.alignChildren = ["left", "center"]; 
        controlsGroup.spacing = 5;
        
        controlsGroup.add("statictext", undefined, "Buscar:");
        this.elements.searchBox = controlsGroup.add("edittext", undefined, "");
        this.elements.searchBox.preferredSize.width = 120;
        
        controlsGroup.add("statictext", undefined, "Categoria:");
        this.elements.categoryDropdown = controlsGroup.add("dropdownlist", undefined, ["Todas"]);
        this.elements.categoryDropdown.selection = 0; 
        this.elements.categoryDropdown.preferredSize.width = 120;
        
        this.elements.refreshBtn = simpleButton(controlsGroup, { labelTxt: "â†»", width: 30, height: 25 });

        var row3 = controlsPanel.add('group'); 
        row3.orientation = 'row'; 
        row3.alignChildren = ["left", "center"]; 
        row3.spacing = 5;
        
        row3.add("statictext", undefined, "Tipo:"); 
        this.elements.typeFilter = row3.add("dropdownlist", undefined, ["Todos os Tipos", "Imagens", "Vetores"]); 
        this.elements.typeFilter.selection = 0;
        this.elements.typeFilter.preferredSize.width = 110;
        
        row3.add("statictext", undefined, "Ordenar por:"); 
        this.elements.sortFilter = row3.add("dropdownlist", undefined, ["Nome (A-Z)", "Data (Mais Recentes)"]); 
        this.elements.sortFilter.selection = 0;
        this.elements.sortFilter.preferredSize.width = 130;
        
        var gridWrapper = leftColumn.add('group'); 
        gridWrapper.orientation = 'column'; 
        gridWrapper.alignment = 'left';
        
        var gridContainer = gridWrapper.add("group"); 
        gridContainer.orientation = 'column'; 
        gridContainer.spacing = UI_CONFIG.grid.gap;
        
        var g = UI_CONFIG.grid; var paddedThumbSize = g.thumbSize - (g.padding * 2);
        for (var r = 0; r < g.rows; r++) {
            var rowGroup = gridContainer.add('group'); rowGroup.orientation = 'row'; rowGroup.spacing = g.gap; rowGroup.alignChildren = ['left', 'center'];
            for (var c = 0; c < g.columns; c++) {
                var slot = rowGroup.add('group'); slot.orientation = 'stack'; slot.minimumSize = [g.thumbSize, g.thumbSize]; slot.maximumSize = [g.thumbSize, g.thumbSize]; slot.margins = 0; slot.uniqueId = this.gridSlots.length;
                setBgColor(slot, THEME.slotBgColor);
        
                var thumbBounds = [g.padding, g.padding, g.padding + paddedThumbSize, g.padding + paddedThumbSize];
                
                // Elementos prÃ©-criados
                slot.thumb = slot.add("image", thumbBounds);
                slot.aiIcon = slot.add("image", thumbBounds, D9T_AI_ICON);
                slot.placeholder = slot.add("statictext", undefined, 'ðŸ“„');
        
                slot.placeholder.alignment = ['fill', 'fill']; slot.placeholder.graphics.font = ScriptUI.newFont("Arial", "Regular", 40); slot.placeholder.justify = 'center'; setFgColor(slot.placeholder, THEME.normalColor);
                slot.clickCatcher = slot.add('group'); slot.clickCatcher.alignment = ['fill', 'fill']; slot.clickCatcher.onDraw = function() {}; slot.clickCatcher.addEventListener('click', this.handleIconClick);
                
                // Ocultar todos inicialmente
                slot.thumb.visible = false;
                slot.aiIcon.visible = false;
                slot.placeholder.visible = false;
                slot.iconData = null;
                slot.visible = false;
        
                this.gridSlots.push(slot);
            }
        }

        var paginationGroup = leftColumn.add('group'); 
        paginationGroup.orientation = 'row'; 
        paginationGroup.alignChildren = ['center', 'center']; 
        paginationGroup.alignment = 'fill'; 
        paginationGroup.margins.top = 5; 
        paginationGroup.spacing = 8;
        this.elements.prevPageBtn = simpleButton(paginationGroup, { labelTxt: 'â—„', width: 40 });
        this.elements.pageInfo = paginationGroup.add('statictext', undefined, 'PÃ¡gina 0 de 0'); this.elements.pageInfo.alignment = 'fill'; setFgColor(this.elements.pageInfo, THEME.normalColor);
        this.elements.nextPageBtn = simpleButton(paginationGroup, { labelTxt: 'â–º', width: 40 });
        
        var detailsPanel = mainGroup.add("panel", undefined, "Detalhes");
        detailsPanel.orientation = "column"; detailsPanel.alignChildren = ["fill", "top"]; detailsPanel.alignment = ["right", "fill"]; detailsPanel.preferredSize.width = 220;
        setFgColor(detailsPanel, THEME.normalColor); setBgColor(detailsPanel, THEME.detailsBgColor);

        var previewGroup = detailsPanel.add('group'); 
        previewGroup.orientation = 'stack'; 
        previewGroup.alignment = ['center', 'top']; 
        previewGroup.preferredSize = [150, 150];
        setBgColor(previewGroup, THEME.slotBgColor);
        
        var previewPadding = EASY_CONFIG.PREVIEW_PADDING;
        var paddedPreviewSize = 150 - (previewPadding * 2); 
        var previewBounds = [previewPadding, previewPadding, previewPadding + paddedPreviewSize, previewPadding + paddedPreviewSize];
        
        this.elements.previewImage = previewGroup.add("image", previewBounds);
        this.elements.previewAiIcon = previewGroup.add("image", previewBounds, D9T_AI_ICON);
        this.elements.previewPlaceholder = previewGroup.add("statictext", undefined, 'ðŸ“„');
        
        this.elements.previewAiIcon.alignment = ["center", "center"];
        this.elements.previewAiIcon.visible = false;
        this.elements.previewPlaceholder.alignment = ['fill', 'fill']; this.elements.previewPlaceholder.graphics.font = ScriptUI.newFont("Arial", "Bold", 80); this.elements.previewPlaceholder.justify = 'center'; setFgColor(this.elements.previewPlaceholder, THEME.normalColor);
        this.elements.previewImage.visible = false;
        this.elements.previewPlaceholder.visible = true;
        
        var detailsTextGroup = detailsPanel.add("group"); detailsTextGroup.orientation = "column"; detailsTextGroup.alignChildren = ["fill", "top"]; detailsTextGroup.alignment = ["fill", "fill"]; detailsTextGroup.spacing = 5; detailsTextGroup.margins.top = 10;
        this.elements.nameText = detailsTextGroup.add("statictext", undefined, "Nenhum Ãcone", { multiline: true }); this.elements.nameText.graphics.font = ScriptUI.newFont("Arial", "Bold", 12);
        function addDetailRow(label, parent) { parent.add('statictext', undefined, label).graphics.font = ScriptUI.newFont("Arial", "Italic", 9); var textElement = parent.add('statictext', undefined, '-', { multiline: true, truncate: 'end' }); textElement.preferredSize.height = 14; return textElement; }
        this.elements.categoryText = addDetailRow("Categoria:", detailsTextGroup);
        this.elements.typeText = addDetailRow("Tipo:", detailsTextGroup);
        this.elements.sizeText = addDetailRow("Tamanho:", detailsTextGroup);
        this.elements.modifiedText = addDetailRow("Modificado:", detailsTextGroup);
        this.elements.pathText = addDetailRow("Pasta:", detailsTextGroup); this.elements.pathText.preferredSize.height = 28;
        
        var statusPanel = this.win.add("panel", undefined, "Status");
        statusPanel.alignment = 'fill';
        setFgColor(statusPanel, THEME.normalColor); setBgColor(statusPanel, THEME.panelBgColor);
        this.elements.statusBar = statusPanel.add('statictext', undefined, 'Pronto.', { truncate: 'end' }); this.elements.statusBar.alignment = 'fill';
    };
    
    UI.updateGrid = function() {
        var searchTerm = (this.elements.searchBox) ? this.elements.searchBox.text.toLowerCase() : "";
        var selectedCategory = (this.elements.categoryDropdown && this.elements.categoryDropdown.selection) ? this.elements.categoryDropdown.selection.text : "Todas";
        var selectedType = (this.elements.typeFilter && this.elements.typeFilter.selection) ? this.elements.typeFilter.selection.text : "Todos os Tipos";
        var selectedSort = (this.elements.sortFilter && this.elements.sortFilter.selection) ? this.elements.sortFilter.selection.text : "Nome (A-Z)";
        State.filteredIcons = [];
        for (var i = 0; i < State.allIcons.length; i++) {
            var icon = State.allIcons[i];
            var matchesSearch = searchTerm === "" || icon.nome.toLowerCase().indexOf(searchTerm) > -1;
            var matchesCategory = selectedCategory === "Todas" || icon.categoria === selectedCategory;
            var matchesType = false;
            var fileExt = (/[.]/.exec(icon.fullPath)) ? /[^.]+$/.exec(icon.fullPath)[0].toLowerCase() : '';
            if (selectedType === "Todos os Tipos") { matchesType = true; }
            else if (selectedType === "Imagens" && fileExt === 'png') { matchesType = true; }
            else if (selectedType === "Vetores" && fileExt === 'ai') { matchesType = true; }
            if (matchesSearch && matchesCategory && matchesType) { State.filteredIcons.push(icon); }
        }
        if (selectedSort === "Nome (A-Z)") { State.filteredIcons.sort(function(a, b) { if (a.nome.toLowerCase() < b.nome.toLowerCase()) return -1; if (a.nome.toLowerCase() > b.nome.toLowerCase()) return 1; return 0; }); }
        else { State.filteredIcons.sort(function(a, b) { if (a.modified && b.modified) { return b.modified.getTime() - a.modified.getTime(); } return 0; }); }
        var itemsPerPage = UI_CONFIG.grid.columns * UI_CONFIG.grid.rows;
        var totalPages = Math.ceil(State.filteredIcons.length / itemsPerPage) || 1;
        if (State.currentPage >= totalPages) State.currentPage = totalPages - 1;
        if (State.currentPage < 0) State.currentPage = 0;
        this.elements.pageInfo.text = "PÃ¡gina " + (State.currentPage + 1) + " de " + totalPages;
        this.elements.prevPageBtn.enabled = (State.currentPage > 0);
        this.elements.nextPageBtn.enabled = (State.currentPage < totalPages - 1);
        var startIndex = State.currentPage * itemsPerPage;
        
        for (var j = 0; j < this.gridSlots.length; j++) {
            var slot = this.gridSlots[j];
            var iconIndex = startIndex + j;
    
            slot.visible = false;
            slot.iconData = null;
    
            if (iconIndex < State.filteredIcons.length) {
                var iconData = State.filteredIcons[iconIndex];
                slot.iconData = iconData;
                setBgColor(slot, (this.activeSlot === slot) ? THEME.highlightColor : THEME.slotBgColor);
                
                slot.thumb.visible = false;
                slot.aiIcon.visible = false;
                slot.placeholder.visible = true;
                
                try {
                    var imageFile = new File(iconData.fullPath);
                    var fileExt = (/[.]/.exec(imageFile.name)) ? /[^.]+$/.exec(imageFile.name)[0].toLowerCase() : '';
                    
                    if (fileExt === 'png' && imageFile.exists) {
                        slot.thumb.image = imageFile;
                        if (slot.thumb.image != null) { 
                            slot.placeholder.visible = false; 
                            slot.thumb.visible = true; 
                        } else {
                            slot.placeholder.text = 'ðŸ–¼ï¸';
                        }
                    } else if (fileExt === 'ai') {
                        slot.placeholder.visible = false;
                        slot.aiIcon.visible = true;
                    } else {
                        slot.placeholder.text = 'ðŸ“„';
                    }
                } catch (e) {
                    slot.placeholder.text = 'âŒ';
                }
                
                slot.visible = true;
            }
        }
        
        if (!this.activeSlot || !this.activeSlot.visible) {
            var firstVisibleSlot = null;
            for(var k=0; k < this.gridSlots.length; k++) { if(this.gridSlots[k].visible) { firstVisibleSlot = this.gridSlots[k]; break; } }
            if (firstVisibleSlot) { this.updateDetailsPanel(firstVisibleSlot.iconData, firstVisibleSlot); }
            else { this.updateDetailsPanel(null, null); }
        }
        if (this.win) { this.win.layout.layout(true); }
    };
    
    UI.updateDetailsPanel = function(iconData, slot) { 
        State.selectedIconData = iconData; 
        this.highlightSelection(slot); 
        
        this.elements.previewImage.visible = false;
        this.elements.previewAiIcon.visible = false;
        this.elements.previewPlaceholder.visible = true;
        
        if (iconData) { 
            var iconFile = new File(iconData.fullPath);
            var fileExt = (/[.]/.exec(iconFile.name)) ? /[^.]+$/.exec(iconFile.name)[0].toLowerCase() : '';
            
            try {
                if (fileExt === 'png' && iconFile.exists) {
                    this.elements.previewImage.image = iconFile;
                    if (this.elements.previewImage.image != null) { 
                        this.elements.previewPlaceholder.visible = false;
                        this.elements.previewImage.visible = true; 
                    } else {
                        this.elements.previewPlaceholder.text = 'ðŸ–¼ï¸';
                    }
                } else if (fileExt === 'ai') {
                    this.elements.previewPlaceholder.visible = false;
                    this.elements.previewAiIcon.visible = true;
                } else {
                    this.elements.previewPlaceholder.text = 'ðŸ“„';
                }
            } catch (e) {
                this.elements.previewPlaceholder.text = 'âŒ';
            }
            
            this.elements.nameText.text = iconData.nome; 
            this.elements.categoryText.text = iconData.categoria; 
            this.elements.typeText.text = getFileType(iconFile.name); 
            this.elements.sizeText.text = formatFileSize(iconFile.length); 
            this.elements.modifiedText.text = (iconData.modified) ? new Date(iconData.modified).toLocaleString() : "N/A"; 
            this.elements.pathText.text = decodeURI(iconFile.path); 
        } else { 
            this.elements.previewImage.image = null; 
            this.elements.previewPlaceholder.text = ''; 
            this.elements.nameText.text = "Nenhum Ãcone"; 
            this.elements.categoryText.text = "-"; 
            this.elements.typeText.text = "-"; 
            this.elements.sizeText.text = "-"; 
            this.elements.modifiedText.text = "-"; 
            this.elements.pathText.text = "-"; 
        } 
    };
    
    UI.highlightSelection = function(selectedSlot) { 
        if (this.activeSlot && this.activeSlot !== selectedSlot) { 
            try { setBgColor(this.activeSlot, THEME.slotBgColor); } catch (e) {} 
        } 
        if (selectedSlot && selectedSlot.iconData) { 
            setBgColor(selectedSlot, THEME.highlightColor); 
        } 
        this.activeSlot = selectedSlot; 
    };
    
    UI.updateCategoryDropdown = function() {
        var dropdown = this.elements.categoryDropdown;
        var currentSelection = dropdown.selection ? dropdown.selection.text : "Todas";
        while (dropdown.items.length > 0) { dropdown.remove(0); }
        dropdown.add("item", "Todas");
        var categories = {};
        for (var i = 0; i < State.allIcons.length; i++) {
            categories[State.allIcons[i].categoria] = true;
        }
        var sortedCategories = getObjectKeys(categories).sort();
        for (var i = 0; i < sortedCategories.length; i++) {
            var cat = sortedCategories[i];
            if (cat !== "Todas") {
                dropdown.add("item", cat);
            }
        }
        for (var i = 0; i < dropdown.items.length; i++) {
            if (dropdown.items[i].text === currentSelection) {
                dropdown.selection = i;
                return;
            }
        }
        dropdown.selection = 0;
    };
    
    UI.logMessage = function(message, isError) { 
        if (!this.elements.statusBar) { return; } 
        var prefix = isError ? "[ERRO] " : ""; 
        this.elements.statusBar.text = prefix + message; 
    };
    
    UI.assignEventHandlers = function() { 
        var onFilterChange = function() { State.currentPage = 0; UI.updateGrid(); }; 
        this.elements.searchBox.onChanging = onFilterChange; 
        this.elements.categoryDropdown.onChange = onFilterChange; 
        this.elements.typeFilter.onChange = onFilterChange; 
        this.elements.sortFilter.onChange = onFilterChange; 
        addClickHandler(this.elements.refreshBtn, function() { Logic.rescanAndLoadDatabase(); }); 
        addClickHandler(this.elements.nextPageBtn, function() { State.currentPage++; UI.updateGrid(); }); 
        addClickHandler(this.elements.prevPageBtn, function() { State.currentPage--; UI.updateGrid(); }); 
    };
    
    var App = {
        run: function() {
            try {
                UI.build();
                UI.assignEventHandlers();
                if (!Logic.loadCache()) { Logic.rescanAndLoadDatabase(); }
                else { UI.logMessage(State.allIcons.length + " Ã­cones carregados do cache.", false); UI.updateCategoryDropdown(); UI.updateGrid(); }
                UI.win.onClose = function() { UI.activeSlot = null; };
                UI.win.show();
            } catch (e) { alert("Erro ao iniciar a aplicaÃ§Ã£o: " + e.toString() + "\nLinha: " + e.line); }
        }
    };
    
    App.run();

})();